library(fst)
library(data.table)
library(tidyverse)
library(oddstream)
library(AnoFox)

fst::read_fst("prepared_data/london_smart_meter/smart_meters_london.fst") %>% 
  as.data.table() -> dtData

dtData <- dtData[date_time <= as.Date("2012-04-30")]


registerLocalParallel()
dtData %>% 
  get_ts_features(columnID = "id", columnFeatures = "energy") -> tsResults
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      doParallel::stopImplicitCluster()
smartMeterFeatures <- tsResults$result